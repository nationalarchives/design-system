{% extends "./_design-system-base.njk" %}

{% block skipLink %}
{{ tnaSkipLink({
  href: 'main-content',
  text: 'Skip to main content'
}) }}
{{ tnaSkipLink({
  href: group + '-list',
  text: 'Skip to list of ' + group
}) }}
{% endblock %}

{% block main %}
  {% set headings = contents | headingsList %}

  <div class="tna-container">
    <main class="tna-column tna-column--width-3-4 tna-column--width-2-3-medium tna-column--full-small tna-column--full-tiny {{ mainClasses }} tna-section" id="main-content" role="main">
      {% if group|camelToSpace|capitalize == title|capitalize %}
      <h1 class="tna-heading tna-heading--xl">
        {{ title }}
      </h1>
      {% else %}
      <hgroup class="tna-hgroup tna-hgroup--xl">
        <p class="tna-hgroup__supertitle">{{ group|camelToSpace|capitalize }}</p>
        <h1 class="tna-hgroup__title">{{ title }}</h1>
      </hgroup>
      {% endif %}
      {# {% if headings %}
      <ul>
        {%- for heading in headings %}
        <li>
          <a href="#{{ heading.href }}">
            {{ heading.title }}
          </a>
        </li>
        {%- endfor %}
      </ul>
      {% endif %} #}
      {{ contents | safe }}
    </main>
    <nav id="{{ group }}-list" class="tna-column tna-column--width-1-4 tna-column--width-1-3-medium tna-column--full-small tna-column--full-tiny tna-section" role="navigation" aria-label="{{ title }} navigation">
      <h2 class="tna-heading tna-heading--l tna-visually-hidden tna-!--visually-hidden">All {{ group }}</h2>
      <ol class="tna-ds-sidebar">
      {% for item in collections[group] %}
        {% if item.path == path %}
        <li class="tna-ds-sidebar__item tna-ds-sidebar__item--current">
          <a href="/design-system/{{ item.path }}" class="tna-ds-sidebar__link">{{ item.title }}</a>
          {% if headings %}
          {# TODO: Make a marco for this recursion #}
          <ol class="tna-ds-sidebar__sections">
            {%- for heading in headings %}
            <li class="tna-ds-sidebar__section">
              <a href="#{{ heading.href }}" class="tna-ds-sidebar__section-link">
                {{ heading.title }}
              </a>
              {# {%- if heading.children %}
              <ol class="tna-ds-sidebar__sections">
                {%- for child in heading.children %}
                <li class="tna-ds-sidebar__section">
                  <a href="#{{ child.href }}" class="tna-ds-sidebar__section-link">
                    {{ child.title }}
                  </a>
                  {%- if child.children %}
                  <ol class="tna-ds-sidebar__sections">
                    {%- for childChild in child.children %}
                    <li class="tna-ds-sidebar__section">
                      <a href="#{{ childChild.href }}" class="tna-ds-sidebar__section-link">
                        {{ childChild.title }}
                      </a>
                    </li>
                  {%- endfor %}
                  </ol>
                  {%- endif %}
                </li>
              {%- endfor %}
              </ol>
              {%- endif %} #}
            </li>
            {%- endfor %}
          </ol>
          {% endif %}
        </li>
        {% else %}
        <li class="tna-ds-sidebar__item">
          <a href="/design-system/{{ item.path }}" class="tna-ds-sidebar__link">{{ item.title }}</a>
        </li>
        {% endif %}
      {% endfor %}
      </ol>
    </nav>
  </div>
{% endblock %}
